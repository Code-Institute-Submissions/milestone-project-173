{% extends "base.html" %} {% block content %}
<section class="container-fluid content-container-top px-0">
    <!-- Heading start -->
    <div class="row no-gutters">
        <div class="d-none d-lg-block col-lg-4">
            <div class="sign-up-image"></div>
        </div>
        <div class="col col-lg-8">
            <div class="container content-container">
                <!-- Heading start -->
                <div class="row no-gutters">
                    <div class="col-12">
                        <h1 class="text-center headings">{{ page_title }}</h1>
                    </div>
                </div>
                <!-- Heading end -->
                <!-- Sign up form start. Code from https://getbootstrap.com/docs/4.5/components/forms/ -->
                <div class="row no-gutters">
                    <form class="col-12 col-md-10 offset-md-1 needs-validation" method="POST"
                        action="{{ url_for('sign_up') }}" novalidate>
                        <div class="form-group">
                            <label for="first_name">First Name</label>
                            <input type="text" class="form-control" id="first_name" name="first_name"
                                aria-describedby="first_name" pattern="[a-zA-Z]{5,15}$" required />
                        </div>
                        <div class="form-group">
                            <label for="last_name">Last Name</label>
                            <input type="text" class="form-control" id="last_name" name="last_name"
                                aria-describedby="last_name" pattern="[a-zA-Z]{5,15}$" required />
                        </div>
                        <!--Code for pattern attribute is from https://www.w3schools.com/tags/att_input_pattern.asp-->
                        <div class="form-group">
                            <label for="email">Email Address</label>
                            <input type="email" class="form-control" id="email" name="email" aria-describedby="email"
                                pattern="[a-zA-Z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$" required />
                        </div>
                        <!--Code for pattern attribute is from https://www.w3schools.com/tags/att_input_pattern.asp-->
                        <div class="form-group mt-4">
                            <label for="password">Password</label>
                            <input type="password" class="form-control" name="password" id="password"
                                aria-describedby="password" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,30}" required />
                            <div class="invalid-feedback mt-3">Password must be between 8 and 30 characters and contain
                                at least one uppercase, one lowercase letter and one number</div>
                        </div>
                        <div class="form-group mt-4">
                            <label for="confirm-password">Confirm Password</label>
                            <input type="password" class="form-control" name="confirm_password" id="confirm-password"
                                aria-describedby="confirm-password" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,30}"
                                required />
                            <div class="invalid-feedback mt-3">Passwords do not match</div>
                        </div>
                        <div class="form-group mt-4">
                            <div class="custom-control custom-switch">
                                <input type="checkbox" class="custom-control-input custom-switch" id="newsletter-signup"
                                    name="newsletter_signup" required checked>
                                <label class="custom-control-label" for="newsletter-signup">Subscribe to our
                                    newsletter</label>
                            </div>
                        </div>
                        <div class="form-group text-center mt-4 mb-0">
                            <button type="submit" class="btn btn-green">Sign Up</button>
                            <p class="text-center mt-4">
                                Already have an account? Sign in
                                <a href="{{url_for('sign_in')}}">here</a>
                            </p>
                        </div>
                        <!--Code from https://blog.tecladocode.com/handling-the-next-url-when-logging-in-with-flask/-->
                        <div class="form-group d-none">
                            <input type="hidden" name="next" value="{{request.referrer}}" />
                        </div>
                    </form>
                </div>
                <!-- Sign up form end -->
            </div>
        </div>
    </div>
</section>
{% endblock %}
{% block postloadjs %}
<script>
    $('input').on('change', function () {
        if ($(this).attr('id') === 'confirm-password') {
            if ($(this).val() === $('#password').val()) {
                $(this).removeClass('is-invalid').addClass('is-valid')
            } else {
                $(this).removeClass('is-valid').addClass('is-invalid')
            }
        }
        else if ($(this).is(":valid")) {
            if ($(this).attr('id') === 'password' && $('#confirm-password').val() === "") {
                $(this).removeClass('is-invalid').addClass('is-valid')
            } else if ($(this).attr('id') === 'password' && $('#confirm-password').val() !== "") {
                $(this).removeClass('is-invalid').addClass('is-valid')
                if ($(this).val() === $('#confirm-password').val()) {
                    $('#confirm-password').removeClass('is-invalid').addClass('is-valid')
                } else {
                    $('#confirm-password').removeClass('is-valid').addClass('is-invalid')
                }
            } else {
                $(this).removeClass('is-invalid').addClass('is-valid')
            }
        } else {
            if ($(this).attr('id') === 'password' && $('#confirm-password').val() === "") {
                $(this).removeClass('is-valid').addClass('is-invalid')
            } else if ($(this).attr('id') === 'password' && $('#confirm-password').val() !== "") {
                $(this).removeClass('is-valid').addClass('is-invalid')
                $('#confirm-password').removeClass('is-valid').addClass('is-invalid')
            } else {
                $(this).removeClass('is-valid').addClass('is-invalid')
            }
        }
    })

    $('.needs-validation').submit(function(e) {
        if ($(this)[0].checkValidity() === false) {
            e.preventDefault()
            $(this).addClass('was-validated')
        }
    })
</script>
{% endblock %}