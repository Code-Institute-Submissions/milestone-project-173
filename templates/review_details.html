{% extends "base.html" %} {% block content %}
<section class="container-fluid px-0">
    <div class="container content-container-top">
        <div class="row no-gutters">
            <div class="col-12 py-3">
                <a id="current-search" href="{{url_for('reviews', category=product.category)}}"><i
                        class="fas fa-chevron-left pr-2"></i>Back to {{product.category.capitalize()}}</a>
            </div>
        </div>
        <div class="row no-gutters">
            <div class="col-12 col-lg-6 pr-lg-5">
                <img class="card-img product-img" src="{{product.image_url}}" alt="" />
            </div>
            <div class="col-12 col-lg-6 pr-lg-5 features">
                <h3 class="headings">{{product.name}}</h3>
                <table class="table table-borderless features-table mb-0">
                    <tbody>
                        {% if product.colours %}
                        <tr>
                            <th scope="row" class="p-0 pb-3 pr-3">Colours</th>
                            <td class="p-0 pb-3">{{product.colours}}</td>
                        </tr>
                        {% endif %} {% if product.price %}
                        <tr>
                            <th scope="row" class="p-0 pb-3 pr-3">Price</th>
                            <td class="p-0 pb-3">From Â£{{product.price}}</td>
                        </tr>
                        {% endif %} {% if product.display %}
                        <tr>
                            <th scope="row" class="p-0 pb-3 pr-3">Display</th>
                            <td class="p-0 pb-3">{{product.display}}</td>
                        </tr>
                        {% endif %} {% if product.processor_memory_graphics %}
                        <tr>
                            <th scope="row" class="p-0 pb-3 pr-3">
                                Processor, Memory and Graphics
                            </th>
                            <td class="p-0 pb-3">{{product.processor_memory_graphics}}</td>
                        </tr>
                        {% endif %} {% if product.camera_video %}
                        <tr>
                            <th scope="row" class="p-0 pb-3 pr-3">Camera and Video</th>
                            <td class="p-0 pb-3">{{product.camera_video}}</td>
                        </tr>
                        {% endif %} {% if product.battery %}
                        <tr>
                            <th scope="row" class="p-0 pb-3 pr-3">Battery Life</th>
                            <td class="p-0 pb-3">{{product.battery}}</td>
                        </tr>
                        {% endif %} {% if product.connectivity %}
                        <tr>
                            <th scope="row" class="p-0 pb-3 pr-3">Connectivity</th>
                            <td class="p-0 pb-3">{{product.connectivity}}</td>
                        </tr>
                        {% endif %} {% if product.additional_features %}
                        <tr>
                            <th scope="row" class="p-0 pb-3 pr-3">Additional Features</th>
                            <td class="p-0 pb-3">{{product.additional_features}}</td>
                        </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div class="wrapper-grey">
        <div class="container content-container">
            <div class="row no-gutters">
                <div class="col-12">
                    <h2 class="headings product-headings">Ratings & Reviews</h2>
                    <div class="row no-gutters">
                        <div class="col-12 col-md-6 pr-md-4 pr-lg-0">
                            <div class="row no-gutters progress-bars">
                                <div class="col-12 col-lg-3">
                                    <p class="mb-2">Overall Rating</p>
                                </div>
                                <div class="col-12 col-lg-9">
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar"
                                            style="width: calc({{ product.overall_rating }} * 20%)"
                                            aria-valuenow="calc({{ product.overall_rating }} * 20)" aria-valuemin="0"
                                            aria-valuemax="100"></div>
                                    </div>
                                </div>
                                <div class="col-12 col-lg-3">
                                    <p class="mb-2">Performance</p>
                                </div>
                                <div class="col-12 col-lg-9">
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar"
                                            style="width: calc({{ product.performance_rating  }} * 20%)"
                                            aria-valuenow="calc({{ product.performance_rating  }} * 20)"
                                            aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                                <div class="col-12 col-lg-3">
                                    <p class="mb-2">Quality</p>
                                </div>
                                <div class="col-12 col-lg-9">
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar"
                                            style="width: calc({{ product.quality_rating }} * 20%)"
                                            aria-valuenow="calc({{ product.quality_rating }} * 20)" aria-valuemin="0"
                                            aria-valuemax="100"></div>
                                    </div>
                                </div>
                                <div class="col-12 col-lg-3">
                                    <p class="mb-2">Ease of Use</p>
                                </div>
                                <div class="col-12 col-lg-9">
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar"
                                            style="width: calc({{ product.usability_rating }} * 20%)"
                                            aria-valuenow="calc({{ product.usability_rating }} * 20)" aria-valuemin="0"
                                            aria-valuemax="100"></div>
                                    </div>
                                </div>
                                <div class="col-12 col-lg-3">
                                    <p class="mb-2 mb-lg-0">Value for Money</p>
                                </div>
                                <div class="col-12 col-lg-9">
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar"
                                            style="width: calc({{ product.price_rating }} * 20%)"
                                            aria-valuenow="calc({{ product.price_rating }} * 20)" aria-valuemin="0"
                                            aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div>
                            <hr class="d-md-none ratings-divider" />
                        </div>
                        <div class="col-12 col-md-6 pl-md-4 pl-lg-0">
                            <div class="row no-gutters progress-bars">
                                <div class="col-12 col-lg-2 offset-lg-1">
                                    <p class="mb-2">5 Stars</p>
                                </div>
                                <div class="col-12 col-lg-9">
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar"
                                            style="width: calc({{ product.five_stars / reviews|length }} * 100%)"
                                            aria-valuenow="calc({{ product.five_stars / reviews|length }} * 100)"
                                            aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                                <div class="col-12 col-lg-2 offset-lg-1">
                                    <p class="mb-2">4 Stars</p>
                                </div>
                                <div class="col-12 col-lg-9">
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar"
                                            style="width: calc({{ product.four_stars  / reviews|length }} * 100%)"
                                            aria-valuenow="calc({{ product.four_stars  / reviews|length }} * 100)"
                                            aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                                <div class="col-12 col-lg-2 offset-lg-1">
                                    <p class="mb-2">3 Stars</p>
                                </div>
                                <div class="col-12 col-lg-9">
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar"
                                            style="width: calc({{ product.three_stars  / reviews|length }} * 100%)"
                                            aria-valuenow="{{ product.three_stars  / reviews|length }} * 100)"
                                            aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                                <div class="col-12 col-lg-2 offset-lg-1">
                                    <p class="mb-2">2 Stars</p>
                                </div>
                                <div class="col-12 col-lg-9">
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar"
                                            style="width: calc({{ product.two_stars  / reviews|length }} * 100%)"
                                            aria-valuenow="calc({{ product.two_stars  / reviews|length }} * 100)"
                                            aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                                <div class="col-12 col-lg-2 offset-lg-1">
                                    <p class="mb-2 mb-lg-0">1 Star</p>
                                </div>
                                <div class="col-12 col-lg-9">
                                    <div class="progress">
                                        <div class="progress-bar" role="progressbar"
                                            style="width: calc({{ product.one_star  / reviews|length }} * 100%)"
                                            aria-valuenow="calc({{ product.one_star  / reviews|length }} * 100)"
                                            aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% if session.user %}
            <div class="row no-gutters">
                <div class="col-12 add-review">
                    <a class="btn btn-sm btn-green" href="{{url_for('add_review', product_id=product._id)}}">Add
                        Review</a>
                </div>
            </div>
            {% endif %}
            <div class="row no-gutters">
                <div class="col-12">
                    <hr class="mb-4 mt-0">
                    {% for review in reviews %} {% if loop.index < reviews|length %}
                    <div class="card review-card border-0">
                        <div class="card-body p-0">
                            <div class="d-block d-md-inline-block">
                                <h4 class="review-title mb-2">
                                    {{review.review_title}}</h4>
                                <div class="mb-2">
                                    {% if review.overall_rating == 1 %}
                                    <i class="fas fa-star yellow-star"></i>
                                    {% elif review.overall_rating == 2 %}
                                    <i class="fas fa-star yellow-star mr-1"></i><i class="fas fa-star yellow-star"></i>
                                    {% elif review.overall_rating == 3 %}
                                    <i class="fas fa-star yellow-star mr-1"></i><i
                                        class="fas fa-star yellow-star mr-1"></i><i class="fas fa-star yellow-star"></i>
                                    {% elif review.overall_rating == 4 %}
                                    <i class="fas fa-star yellow-star mr-1"></i><i
                                        class="fas fa-star yellow-star mr-1"></i><i
                                        class="fas fa-star yellow-star mr-1"></i><i class="fas fa-star yellow-star"></i>
                                    {% else %}
                                    <i class="fas fa-star yellow-star mr-1"></i><i
                                        class="fas fa-star yellow-star mr-1"></i><i
                                        class="fas fa-star yellow-star mr-1"></i><i
                                        class="fas fa-star yellow-star mr-1"></i><i class="fas yellow-star fa-star"></i>
                                    {% endif %}
                                </div>
                            </div>
                            {% if current_user|lower == review.created_by|lower %}
                            <div class="float-right">
                                <a class="btn btn-review" href="{{url_for('edit_review', review_id=review._id)}}"><i
                                        class="far fa-edit"></i></a>
                                <a class="btn btn-review" href="{{url_for('delete_review', review_id=review._id)}}"><i
                                        class="fas fa-trash"></i></a>
                            </div>
                            {% endif %}
                            <p class="mb-2">{{ review.review }}</p>
                            <p><small>Reviewed by {{review.created_by}} on {{review.date_added}}</small></p>
                            <div id="{{review._id}}" class="row no-gutters">
                                <div class="col-6 text-center mb-0">
                                    <small><button class="btn btn-sm upvote py-0"><i
                                                class="far fa-thumbs-up"></i></button><span>{% if review.up_vote %}{{review.up_vote}}{% else %}0{% endif %}</span></small>
                                </div>
                                <div class="col-6 text-center mb-0">
                                    <small><button class="btn btn-sm downvote py-0"><i
                                                class="far fa-thumbs-down"></i></button><span>{% if review.down_vote%}{{review.down_vote}}{% else %}0{% endif %}</span></small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr class="my-4">
                    {% else %}
                    <div class="card review-card border-0 mb-4">
                        <div class="card-body p-0">
                            <div class="d-block d-md-inline-block">
                                <h4 class="review-title mb-2">
                                    {{review.review_title}}
                                </h4>
                                <div class="mb-2">
                                    {% if review.overall_rating == 1 %}
                                    <i class="fas fa-star yellow-star mr-1"></i>
                                    {% elif review.overall_rating == 2 %}
                                    <i class="fas fa-star yellow-star mr-1"></i><i class="fas fa-star yellow-star"></i>
                                    {% elif review.overall_rating == 3 %}
                                    <i class="fas fa-star yellow-star mr-1"></i><i
                                        class="fas fa-star yellow-star mr-1"></i><i class="fas fa-star yellow-star"></i>
                                    {% elif review.overall_rating == 4 %}
                                    <i class="fas fa-star yellow-star mr-1"></i><i
                                        class="fas fa-star yellow-star mr-1"></i><i
                                        class="fas fa-star yellow-star mr-1"></i><i class="fas fa-star yellow-star"></i>
                                    {% else %}
                                    <i class="fas fa-star yellow-star mr-1"></i><i
                                        class="fas fa-star yellow-star mr-1"></i><i
                                        class="fas fa-star yellow-star mr-1"></i><i
                                        class="fas fa-star yellow-star mr-1"></i><i class="fas yellow-star fa-star"></i>
                                    {% endif %}
                                </div>
                            </div>
                            {% if current_user == review.created_by %}
                            <div class="float-right">
                                <a class="btn btn-review" href="{{url_for('edit_review', review_id=review._id)}}"><i
                                        class="far fa-edit"></i></a>
                                <a class="btn btn-review" href="{{url_for('delete_review', review_id=review._id)}}"><i
                                        class="fas fa-trash"></i></a>
                            </div>
                            {% endif %}
                            <p class="mb-2">{{ review.review }}</p>
                            <p class="mb-3"><small>Reviewed by {{review.created_by}} on
                                    {{review.date_added}}</small>
                            </p>
                            <div id="{{review._id}}" class="row no-gutters">
                                <div class="col-6 text-center">
                                    <small><button class="btn btn-sm upvote py-0"><i
                                                class="far fa-thumbs-up"></i></button><span>{% if review.up_vote %}{{review.up_vote}}{% else %}0{% endif %}</span></small>
                                </div>
                                <div class="col-6 text-center">
                                    <small><button class="btn btn-sm downvote py-0"><i
                                                class="far fa-thumbs-down"></i></button><span>{% if review.down_vote%}{{review.down_vote}}{% else %}0{% endif %}</span></small>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endif %}
                {% endfor %}
            </div>
        </div>
    </div>
</section>
{% endblock %}
{% block postloadjs %}
<script src="{{ url_for('static', filename='js/product-details.js') }}"></script>
{% endblock %}